{"remainingRequest":"/Users/mac/Desktop/vue-template/vue3-typescript-template/node_modules/babel-loader/lib/index.js!/Users/mac/Desktop/vue-template/vue3-typescript-template/node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!/Users/mac/Desktop/vue-template/vue3-typescript-template/src/service/index.ts","dependencies":[{"path":"/Users/mac/Desktop/vue-template/vue3-typescript-template/src/service/index.ts","mtime":1629101044765},{"path":"/Users/mac/Desktop/vue-template/vue3-typescript-template/node_modules/cache-loader/dist/cjs.js","mtime":1618564461767},{"path":"/Users/mac/Desktop/vue-template/vue3-typescript-template/node_modules/babel-loader/lib/index.js","mtime":1618564461759},{"path":"/Users/mac/Desktop/vue-template/vue3-typescript-template/node_modules/ts-loader/index.js","mtime":1626082511152}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJ2YW50L2VzL3RvYXN0L3N0eWxlIjsKaW1wb3J0IF9Ub2FzdCBmcm9tICJ2YW50L2VzL3RvYXN0IjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgQ09ERSwgQ09ERV9URVhUIH0gZnJvbSAnLi9jb2RlJzsKaW1wb3J0IHsgc3RvcmUgfSBmcm9tICdAL3N0b3JlL2luZGV4JzsKaW1wb3J0IHsgTXV0YXRpb25zRW51bSB9IGZyb20gJ0Avc3RvcmUvbXV0YXRpb24tdHlwZXMnOwppbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICd2dWUtcm91dGVyJzsKY29uc29sZS5sb2codXNlUm91dGVyKTsKYXhpb3MuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICBpZiAoIWNvbmZpZy5oaWRlbG9hZGluZykgewogICAgX1RvYXN0LmxvYWRpbmcoewogICAgICBtZXNzYWdlOiAn5Yqg6L295LitLi4uJywKICAgICAgZm9yYmlkQ2xpY2s6IHRydWUsCiAgICAgIGxvYWRpbmdUeXBlOiAnc3Bpbm5lcicKICAgIH0pOwogIH0KCiAgaWYgKHN0b3JlLnN0YXRlLnRva2VuKSB7CiAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gYHRva2VuICR7c3RvcmUuc3RhdGUudG9rZW59YDsKICB9CgogIHJldHVybiBjb25maWc7Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOwpheGlvcy5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKGZ1bmN0aW9uIChyZXNwb25zZSkgewogIF9Ub2FzdC5jbGVhcigpOwoKICBjb25zdCB7CiAgICBzdGF0dXMKICB9ID0gcmVzcG9uc2U7CiAgY29uc3QgaW5kZXggPSBDT0RFLmZpbmRJbmRleChyZXMgPT4gcmVzID09PSBzdGF0dXMpOwoKICBpZiAoQ09ERS5pbmNsdWRlcyhzdGF0dXMpKSB7CiAgICBfVG9hc3QuZmFpbChDT0RFX1RFWFRbaW5kZXhdKTsKCiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoQ09ERV9URVhUW2luZGV4XSk7CiAgfQoKICBpZiAoc3RhdHVzID09PSA0MDApIHsKICAgIHN0b3JlLmNvbW1pdChNdXRhdGlvbnNFbnVtLlJlbW92ZVRva2VuKTsgLy8gcm91dGVyLmN1cnJlbnRSb3V0ZS5wYXRoICE9PSAnbG9naW4nICYmCiAgICAvLyAgIHJvdXRlci5yZXBsYWNlKHsKICAgIC8vICAgICBwYXRoOiAnbG9naW4nLAogICAgLy8gICAgIHF1ZXJ5OiB7IHJlZGlyZWN0OiByb3V0ZXIuY3VycmVudFJvdXRlLnBhdGggfSwKICAgIC8vICAgfSkKICB9CgogIHJldHVybiByZXNwb25zZTsKfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7"},{"version":3,"sources":["/Users/mac/Desktop/vue-template/vue3-typescript-template/src/service/index.ts"],"names":[],"mappings":";;AACA,OAAO,KAAP,MAAkB,OAAlB;AAEA,SAAS,IAAT,EAAe,SAAf,QAAgC,QAAhC;AACA,SAAS,KAAT,QAAsB,eAAtB;AACA,SAAS,aAAT,QAA8B,wBAA9B;AACA,SAAS,SAAT,QAA0B,YAA1B;AAEA,OAAO,CAAC,GAAR,CAAY,SAAZ;AACA,KAAK,CAAC,YAAN,CAAmB,OAAnB,CAA2B,GAA3B,CAA+B,UAAU,MAAV,EAAqB;AAClD,MAAI,CAAC,MAAM,CAAC,WAAZ,EAAyB;AACvB,WAAM,OAAN,CAAc;AACZ,MAAA,OAAO,EAAE,QADG;AAEZ,MAAA,WAAW,EAAE,IAFD;AAGZ,MAAA,WAAW,EAAE;AAHD,KAAd;AAKD;;AAAC,MAAI,KAAK,CAAC,KAAN,CAAY,KAAhB,EAAuB;AACvB,IAAA,MAAM,CAAC,OAAP,CAAe,aAAf,GAA+B,SAAS,KAAK,CAAC,KAAN,CAAY,KAAK,EAAzD;AACD;;AAED,SAAO,MAAP;AACD,CAZD,EAYG,UAAU,KAAV,EAAmE;AAEpE,SAAO,OAAO,CAAC,MAAR,CAAe,KAAf,CAAP;AACD,CAfD;AAkBA,KAAK,CAAC,YAAN,CAAmB,QAAnB,CAA4B,GAA5B,CAAgC,UAAU,QAAV,EAAkB;AAChD,SAAM,KAAN;;AACA,QAAM;AAAE,IAAA;AAAF,MAAa,QAAnB;AACA,QAAM,KAAK,GAAG,IAAI,CAAC,SAAL,CAAgB,GAAD,IAAiB,GAAG,KAAK,MAAxC,CAAd;;AACA,MAAI,IAAI,CAAC,QAAL,CAAc,MAAd,CAAJ,EAA2B;AACzB,WAAM,IAAN,CAAW,SAAS,CAAC,KAAD,CAApB;;AACA,WAAO,OAAO,CAAC,MAAR,CAAe,SAAS,CAAC,KAAD,CAAxB,CAAP;AACD;;AACD,MAAI,MAAM,KAAK,GAAf,EAAoB;AAClB,IAAA,KAAK,CAAC,MAAN,CAAa,aAAa,CAAC,WAA3B,EADkB,CAElB;AACA;AACA;AACA;AACA;AACD;;AACD,SAAO,QAAP;AACD,CAjBD,EAiBG,UAAU,KAAV,EAAmE;AAEpE,SAAO,OAAO,CAAC,MAAR,CAAe,KAAf,CAAP;AACD,CApBD","sourcesContent":["\nimport axios from 'axios'\nimport { Toast } from 'vant'\nimport { CODE, CODE_TEXT } from './code'\nimport { store } from '@/store/index'\nimport { MutationsEnum } from '@/store/mutation-types'\nimport { useRouter } from 'vue-router'\n\nconsole.log(useRouter)\naxios.interceptors.request.use(function (config: any) {\n  if (!config.hideloading) {\n    Toast.loading({\n      message: '加载中...',\n      forbidClick: true,\n      loadingType: 'spinner',\n    })\n  } if (store.state.token) {\n    config.headers.Authorization = `token ${store.state.token}`\n  }\n\n  return config\n}, function (error: AxiosLib.ExtendsAxiosError<FetchResponse.Response>) {\n\n  return Promise.reject(error)\n})\n\n\naxios.interceptors.response.use(function (response) {\n  Toast.clear()\n  const { status } = response\n  const index = CODE.findIndex((res: number) => res === status)\n  if (CODE.includes(status)) {\n    Toast.fail(CODE_TEXT[index])\n    return Promise.reject(CODE_TEXT[index])\n  }\n  if (status === 400) {\n    store.commit(MutationsEnum.RemoveToken)\n    // router.currentRoute.path !== 'login' &&\n    //   router.replace({\n    //     path: 'login',\n    //     query: { redirect: router.currentRoute.path },\n    //   })\n  }\n  return response\n}, function (error: AxiosLib.ExtendsAxiosError<FetchResponse.Response>) {\n\n  return Promise.reject(error)\n})\n\n\n"],"sourceRoot":""}]}